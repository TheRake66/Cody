<?php
namespace Kernel\Security\Vulnerability;

use Kernel\Html\Javascript;
use Kernel\Html\Output;
use Kernel\Security\Configuration;



/**
 * Librairie  de gestion de la vulnérabilité self XSS (Self Cross-Site Scripting).
 *
 * @author Thibault Bustos (TheRake66)
 * @version 1.0
 * @package Kernel\Security\Vulnerability
 * @category Framework source
 * @license MIT License
 * @copyright © 2022 - Thibault BUSTOS (TheRake66)
 */
abstract class SelfXss {

    /**
     * Écrit un message d'avertissement dans la console du navigateur.
     * 
     * @return void
     */
    static function prevent() {
        if (Configuration::get()->security->prevent_self_xss) {
            Output::add([
                Javascript::log('Stop!', [
                    'color' => '#ff0000',
                    'font-size' => '6em',
                    'font-weight' => 'bold',
                    '-webkit-text-stroke-width' => '2px',
                    '-webkit-text-stroke-color' => '#000000'
                ]),
                Javascript::log('Il s’agit d’une fonctionnalité de navigateur conçue pour les développeurs. Si quelqu’un vous a invité(e) à copier-coller quelque chose ici pour activer une fonctionnalité ou soit-disant pirater le compte d’un tiers, sachez que c’est une escroquerie permettant à cette personne d’accéder à votre compte ou à votre ordinateur. Si vous êtes sûr(e) de ce que vous faites, vous pouvez ignorer ce message.', [
                    'color' => '#ffffff',
                    'font-size' => '1.7em',
                    'font-weight' => 'bold',
                    '-webkit-text-stroke-width' => '1px',
                    '-webkit-text-stroke-color' => '#000000'
                ]),
                Javascript::log('Voir https://en.wikipedia.org/wiki/Self-XSS pour plus d’informations.', [
                    'color' => '#ffffff',
                    'font-size' => '1.7em',
                    'font-weight' => 'bold',
                    '-webkit-text-stroke-width' => '1px',
                    '-webkit-text-stroke-color' => '#000000'
                ])
            ]);
        }
    }

}

?>